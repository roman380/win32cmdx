<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>win32cmdx: dump zip file structure</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="contents">
<h1>dump zip file structure</h1><h3>Release 1.x </h3><dl class="version"><dt><b>Version:</b></dt><dd>1.0 (r8)</dd></dl>
<dl class="author"><dt><b>Author:</b></dt><dd>Hiroshi Kuno &lt;<a href="http://code.google.com/p/win32cmdx/">http://code.google.com/p/win32cmdx/</a>&gt;</dd></dl>
<dl class="user"><dt><b>License:</b></dt><dd>New BSD License Copyright &copy; 2010 by Hiroshi Kuno <br/>
本ソフトウェアは無保証かつ無償で提供します。利用、再配布、改変は自由です。</dd></dl>
<hr/>
 <h2><a class="anchor" id="intro">
はじめに</a></h2>
<p>zipdumpは、ZIPファイルの構造をダンプ出力するコンソールアプリケーションです。 壊れたZIPファイルの解析に便利です。</p>
<h2><a class="anchor" id="func">
特徴</a></h2>
<ul>
<li>PKZIP version 6.3.2(September 28, 2007) のファイルフォーマット仕様に基づき、構造単位でのダンプを行います。</li>
<li>対象ZIPファイル名に ".zipdump.txt" を付加した名前のテキストファイルを生成し、ダンプ結果を出力します。</li>
</ul>
<h2><a class="anchor" id="env">
動作環境</a></h2>
<p>Windows2000以降。 WindowsXP/Vista/Windows7 にて動作確認済み。</p>
<h2><a class="anchor" id="install">
インストール方法</a></h2>
<p>配布ファイル zipdump.exe を、PATHが通ったフォルダにコピーしてください。 アインインストールするには、そのコピーしたファイルを削除してください。</p>
<h2><a class="anchor" id="usage">
使い方</a></h2>
<div class="fragment"><pre class="fragment">usage :zipdump [-h?fqsr] [-d&lt;DIR&gt;] file1.zip file2.zip ...
  version 1.0 (r8)
  -h -?      this help
  -f         full dump
  -q         quiet mode
  -s         output to stdout instend of files(*.zipdump.txt)
  -r         recursive search under the input-file's folder(wildcard needed)
  -d&lt;DIR&gt;    output to DIR
  fileN.cpp  input-files. wildcard OK
</pre></div><h2><a class="anchor" id="example">
出力例</a></h2>
<div class="fragment"><pre class="fragment">zipdump -s test.zip 
&lt;&lt;&lt; test.zip &gt;&gt;&gt; begin.
[Local file header #1] offset : 0(0x0000000000000000)
     local file header signature : 0x04034B50
       version needed to extract : 20
        general purpose bit flag : 0x0000
              compression method : 0x0008
              last mod file time : 0x0B8B
              last mod file date : 0x3C30
                                 * 2010-01-16T01:28:22
                          crc-32 : 0x259F1D1A
                 compressed size : 417(0x000001A1)
               uncompressed size : 803(0x00000323)
                file name length : 15(0x000F)
              extra field length : 122(0x007A)
[Local file name #1] offset : 30(0x000000000000001E)
$‾version-up.pl
[Local extra field #1] offset : 45(0x000000000000002D)
+00000000 : 53 44 65 00 BC 00 00 00-00 08 00 FE E7 B7 29 63 :SDe...........)c
+00000010 : 64 60 69 10 61 60 60 30-60 80 00 1F 20 66 64 05 :d`i.a``0`... fd.
+00000020 : 33 59 45 81 44 94 10 DB-91 8D 1C FF 99 8F 5A 14 :3YE.D.........Z.
+00000030 : E5 BE 63 C6 2D C7 C8 C4-C0 C0 C4 50 C0 C0 02 96 :..c.-......P....
+00000040 : 96 60 F8 CF 28 CF 00 12-03 A9 55 00 12 0A 60 B6 :.`..(.....U...`.
+00000050 : 08 44 9C 11 22 2E 04 A6-54 20 62 78 EC 04 99 B7 :.D.."...T bx....
+00000060 : 92 41 08 C5 3C 45 20 1B-00 55 54 0D 00 07 A6 97 :.A..&lt;E ..UT.....
+00000070 : 50 4B C1 9B 50 4B A6 97-50 4B                   :PK..PK..PK      
[File data #1] offset : 167(0x00000000000000A7)
** skip file data(417 bytes) **; Use -f option to dump the data
[Local file header #2] offset : 584(0x0000000000000248)
     local file header signature : 0x04034B50
       version needed to extract : 20
        general purpose bit flag : 0x0000
              compression method : 0x0008
              last mod file time : 0x8B24
              last mod file date : 0x3B43
                                 * 2009-10-03T17:25:08
                          crc-32 : 0xE02D4FB6
                 compressed size : 126(0x0000007E)
               uncompressed size : 139(0x0000008B)
                file name length : 15(0x000F)
              extra field length : 122(0x007A)
[Local file name #2] offset : 614(0x0000000000000266)
version-filt.pl
[Local extra field #2] offset : 629(0x0000000000000275)
+00000000 : 53 44 65 00 BC 00 00 00-00 08 00 FE E7 B7 29 63 :SDe...........)c
+00000010 : 64 60 69 10 61 60 60 30-60 80 00 1F 20 66 64 05 :d`i.a``0`... fd.
+00000020 : 33 59 45 81 44 94 10 DB-91 8D 1C FF 99 8F 5A 14 :3YE.D.........Z.
+00000030 : E5 BE 63 C6 2D C7 C8 C4-C0 C0 C4 50 C0 C0 02 96 :..c.-......P....
+00000040 : 96 60 F8 CF 28 CF 00 12-03 A9 55 00 12 0A 60 B6 :.`..(.....U...`.
+00000050 : 08 44 9C 11 22 2E 04 A6-54 20 62 78 EC 04 99 B7 :.D.."...T bx....
+00000060 : 92 41 08 C5 3C 45 20 1B-00 55 54 0D 00 07 64 0A :.A..&lt;E ..UT...d.
+00000070 : C7 4A E5 9C 50 4B A8 E7-D9 4A                   :.J..PK...J      
[File data #2] offset : 751(0x00000000000002EF)
** skip file data(126 bytes) **; Use -f option to dump the data
[Local file header #3] offset : 877(0x000000000000036D)
     local file header signature : 0x04034B50
       version needed to extract : 20
        general purpose bit flag : 0x0000
              compression method : 0x0008
              last mod file time : 0xBB9C
              last mod file date : 0x3B43
                                 * 2009-10-03T23:28:56
                          crc-32 : 0x6E1AD785
                 compressed size : 414(0x0000019E)
               uncompressed size : 802(0x00000322)
                file name length : 13(0x000D)
              extra field length : 122(0x007A)
[Local file name #3] offset : 907(0x000000000000038B)
version-up.pl
[Local extra field #3] offset : 920(0x0000000000000398)
+00000000 : 53 44 65 00 BC 00 00 00-00 08 00 FE E7 B7 29 63 :SDe...........)c
+00000010 : 64 60 69 10 61 60 60 30-60 80 00 1F 20 66 64 05 :d`i.a``0`... fd.
+00000020 : 33 59 45 81 44 94 10 DB-91 8D 1C FF 99 8F 5A 14 :3YE.D.........Z.
+00000030 : E5 BE 63 C6 2D C7 C8 C4-C0 C0 C4 50 C0 C0 02 96 :..c.-......P....
+00000040 : 96 60 F8 CF 28 CF 00 12-03 A9 55 00 12 0A 60 B6 :.`..(.....U...`.
+00000050 : 08 44 9C 11 22 2E 04 A6-54 20 62 78 EC 04 99 B7 :.D.."...T bx....
+00000060 : 92 41 08 C5 3C 45 20 1B-00 55 54 0D 00 07 A8 5F :.A..&lt;E ..UT...._
+00000070 : C7 4A 74 9C 50 4B A8 E7-D9 4A                   :.Jt.PK...J      
[File data #3] offset : 1042(0x0000000000000412)
** skip file data(414 bytes) **; Use -f option to dump the data
unknown signature:02014b50
skip unknown data 72(0x48) bytes
unknown signature:4b504b50
skip unknown data 76(0x4C) bytes
unknown signature:02014b50
skip unknown data 72(0x48) bytes
unknown signature:06054b50
skip unknown data 18(0x12) bytes
&lt;&lt;&lt; test.zip &gt;&gt;&gt; end.

</pre></div><h2><a class="anchor" id="pending">
欠けている機能</a></h2>
<ul>
<li>RVAテーブルの比較を行っていません。<ul>
<li>このテーブルの中身は補助構造へのオフセットとサイズなので、それらの値を比較しても意味がありません。 比較すべきはオフセット先の補助構造ですが、その構造の形式が不明なため実現できていません。</li>
<li>補助構造は .rdata セクションのRAWDATA中に埋め込まれており、バイト列としての比較は出来ています。</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="links">
リンク</a></h2>
<ul>
<li><a href="http://code.google.com/p/win32cmdx/">http://code.google.com/p/win32cmdx/</a> - zipdump開発サイト</li>
</ul>
<h2><a class="anchor" id="download">
ダウンロード</a></h2>
<ul>
<li><a href="http://code.google.com/p/win32cmdx/downloads/list">http://code.google.com/p/win32cmdx/downloads/list</a> - 最新版 version 1.0 (r8) [October 3, 2009]</li>
</ul>
<h2><a class="anchor" id="changelog">
改訂履歴</a></h2>
<h3><a class="anchor" id="Rel100">
version-1.0 [October 3, 2009] 公開初版</a></h3>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Sat Jan 16 01:51:37 2010 for win32cmdx by&nbsp;
<a href="http://www.doxygen.org/index.html">
doxygen</a> 1.6.1 </small></address>
</body>
</html>
